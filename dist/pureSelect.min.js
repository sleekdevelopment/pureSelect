!function(t){var e={};function s(i){if(e[i])return e[i].exports;var l=e[i]={i:i,l:!1,exports:{}};return t[i].call(l.exports,l,l.exports,s),l.l=!0,l.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},s.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=1)}([function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.PureSelect=class{constructor(t,e={},s=[]){this.target=null,this.select=null,this.display=null,this.selected=null,this.list=null,this.value=null,this.isLarge=!0,this.filter=null,this.query={},this.options=[],this.multi=!1,this.settings={},this.ul=null,this.selectOptions=[],this.selected={},this.value={},this.selectOptions=s,console.log("pure select"),this.init(t,e)}storeManager(t){console.log("slected"),t.classList.add("selected"),this.multi?this.multiSelectedUpdate(t):this.singleSelectedUpdate(t),this.settings.onSelect&&this.settings.onSelect(this.value,this.select)}getValById(t){return this.selectOptions.find(e=>e&&e.id==t)}multiSelectedUpdate(t){let e,s=t.getAttribute("data-id");this.value[s]||(this.display.insertAdjacentHTML("beforeend",this.multiResultTemplate(t.innerHTML)),this.selected[s]=t,(e=this.getValById(s))&&(this.value[s]=e))}singleSelectedUpdate(t){let e=t.getAttribute("data-id");this.display.innerHTML=this.settings.resultTemplate(t.innerHTML),this.value[0]=this.getValById(e),this.selected[0]=t}setValues(t){t.forEach(t=>{this.options[t]&&this.storeManager(this.options[t])})}removeValue(t){this.selected[t]&&delete this.selected[t],this.value[t]&&delete this.value[t];let e=this.display.querySelector(`[data-id="${t}"]`);e&&e.remove(),this.positionList()}init(t,e){switch(console.log("init"),typeof t){case"object":break;case"string":this.target=document.querySelector(`${t}`),this.multi=this.target.multiple}this.settings=this.getSettings(e),this.buildSelect(),this.setOverflow(),this.target.parentNode.replaceChild(this.select,this.target),this.target.style.display="none",this.select.appendChild(this.target),document.addEventListener("click",this.handleClickOff.bind(this)),this.positionList(),0==this.selectOptions.length&&this.settings&&this.settings.fetchRemote&&(this.handleFilterKeyup(),this.select.classList.add("large"))}buildSelect(){console.log("buildSelect"),this.select=document.createElement("div"),this.select.classList.add("select"),this.select.classList.add(this.settings.class),this.select.setAttribute("tabindex",this.target.tabIndex),this.select.addEventListener("keydown",this.handleSelectKeydown.bind(this)),this.display=document.createElement("span"),this.display.classList.add("value"),this.display.addEventListener("click",this.handleDisplayClick.bind(this)),this.select.appendChild(this.display),this.buildList()}setOverflow(){}createButton(){if(this.settings&&this.settings.createButton){let t=document.createElement("div");t.classList.add("create-btn"),this.list.appendChild(t)}}buildList(){console.log("buildList"),this.list=document.createElement("div"),this.ul=document.createElement("ul"),this.list.classList.add("list"),this.list.setAttribute("tabindex","-1"),this.buildFilter(),this.ul.addEventListener("scroll",this.throttle(this.handleScroll.bind(this),1e3)),this.ul.addEventListener("click",t=>this.handleOptionClick(t)),this.createButton(),this.list.appendChild(this.ul),this.buildOptions(this.selectOptions),this.select.appendChild(this.list)}stringify(t){return"object"==typeof t?JSON.stringify(t):t}checkForCustomTemplate(t,e){this.settings&&this.settings.optionTemplate?this.display.insertAdjacentHTML("beforeend",this.multiResultTemplate(t.innerHTML)):t.innerHTML=e.label}buildOptions(t){console.log("buildOptions");let e=document.createDocumentFragment(),s=document.createDocumentFragment(),i=t.length;for(let l=0;l<i;l++){let i=document.createElement("li"),n=document.createElement("option");i.setAttribute("data-id",t[l].id),this.checkForCustomTemplate(i,t[l]),this.selected[t[l].id]&&i.classList.add("selected"),n.setAttribute("value",this.stringify(t[l].value)),n.innerHTML=t[l].label,e.appendChild(i),s.appendChild(n),this.options[t[l].label]=i}this.target.appendChild(s),this.ul.appendChild(e)}handleRemove(t){let e=t.parentNode,s=e.getAttribute("data-id");e.remove(),this.selected[s]&&(this.selected[s].classList.remove("selected"),delete this.selected[s]),this.value[s]&&delete this.value[s],this.positionList(),this.settings&&this.settings.onRemove&&this.settings.onRemove(this.value,this.select)}handleDisplayClick(t){t.preventDefault(),t.target&&t.target.classList.contains("ps-chip-del")?this.handleRemove(t.target):(this.list.classList.add("open"),this.isLarge&&this.filter.focus())}positionList(){console.log("positionList"),this.isLarge&&(this.list.style.top=this.display.offsetHeight+"px")}closeList(){console.log("closeList"),this.list.classList.remove("open")}toggleList(){console.log("toggleList"),this.list.classList.contains("open")?(this.list.classList.remove("open"),this.select.focus()):(this.list.classList.add("open"),this.list.focus())}buildFilter(){console.log("buildFilter");let t=document.createElement("div");t.classList.add("filter"),this.filter=document.createElement("input"),this.filter.type="text",this.filter.setAttribute("placeholder",this.settings.filter_placeholder),this.filter.addEventListener("keyup",this.handleFilterKeyup.bind(this)),t.appendChild(this.filter),this.list.appendChild(t)}handleOptionClick(t){console.log("handleOptionClick"),t&&t.target&&t.target.nodeName&&"LI"==t.target.nodeName&&(this.storeManager(t.target),this.settings.closeOnSelect&&this.closeList(),this.clearFilter(),setTimeout(this.positionList.bind(this),200))}activeSpinner(){this.select.classList.add("loading")}disableSpinner(){this.select.classList.remove("loading")}handleRemoteResponseOnFilter(t){this.selectOptions=t.entities,this.query=Object.assign({},this.query,t.query),this.query.page&&(this.query.page=this.query.page++),this.buildOptions(t.entities),this.disableSpinner()}handleRemoteResponseOnScroll(t){this.selectOptions=this.selectOptions.concat(t.entities),this.query=Object.assign({},this.query,t.query),this.query.page&&(this.query.page=this.query.page++),this.buildOptions(t.entities),this.disableSpinner()}initArrays(){this.emptyNode(this.ul),this.emptyNode(this.target),this.selectOptions=[],this.options=[]}DisableSelect(){}ActiveSelect(){}handleFilterKeyup(){if(console.log("handleFilterKeyup"),this.query.term=this.filter.value,this.settings.fetchRemote)this.initArrays(),this.activeSpinner(),this.settings.fetchRemote(this.query,this.handleRemoteResponseOnFilter.bind(this));else for(let t in this.options)this.options.hasOwnProperty(t)&&(this.options[t].innerHTML.substring(0,this.filter.value.length).toLowerCase()==this.filter.value.toLowerCase()?this.options[t].style.display="block":this.options[t].style.display="none")}clearFilter(){console.log("clearFilter"),this.filter.value="";for(let t in this.options)this.options.hasOwnProperty(t)&&(this.options[t].style.display="block")}handleClickOff(t){this.select.contains(t.target)||t.target.classList.contains("ps-chip-del")||this.closeList()}handleScroll(t){console.log("handlescroll"),console.log(t.target.scrollHeight),t.preventDefault(),t.target.scrollTop+t.target.offsetHeight>=t.target.scrollHeight-20&&this.settings.fetchRemote&&(this.activeSpinner(),this.settings.fetchRemote(this.query,this.handleRemoteResponseOnScroll.bind(this)))}handleSelectKeydown(t){console.log("handleSelectKeydown"),console.log(t),this.select===document.activeElement&&32==t.keyCode&&this.toggleList()}multiResultTemplate(t){return`<div class="ps-chip-wrap" data-id="${t}">\n                <span class="ps-chip-label">${t}</span>\n                <span class="del-chip-btn ps-chip-del">x</span>\n              </div>`}getSettings(t){console.log("getSettings");let e={resultTemplate:t=>` ${t} `,fetchRemote:null,filtered:"auto",class:"default",filter_threshold:8,filter_placeholder:"Filter options..."};for(let s in t)e[s]=t[s];return e}destroy(){document.removeEventListener("click",this.handleClickOff.bind(this)),this.emptyNode(this.select),this.select.remove()}emptyNode(t){if(t&&t.firstChild)for(;t.firstChild;)t.removeChild(t.firstChild)}throttle(t,e,s=!1){let i;return function(){let l=this,n=arguments,o=s&&!i;clearTimeout(i),i=setTimeout(function(){i=null,s||t.apply(l,n)},e),o&&t.apply(l,n)}}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});new(s(0).PureSelect)("#demo",{fetchRemote:(t,e)=>{fetch(`https://api.github.com/legacy/repos/search/${encodeURIComponent(t.term)}`).then(t=>t.json()).then(s=>{let i=s.repositories;e({entities:i.map(t=>({label:`${t.name}(${t.owner})`,value:t,id:t.url})),query:{term:t.term,more:i.length>0}})})}})}]);